
# 自動化測試框架（SDET）

這是一個基於 Python 的企業級自動化測試框架，使用 Selenium、pytest 等工具，並具備多環境配置、測試資料管理和測試執行流水線等功能。該框架旨在幫助測試團隊快速建立高效且可擴展的測試系統，適用於 Web 應用程式的測試。

## 目錄

- [特點](#特點)
- [架構](#架構)
- [環境設置](#環境設置)
- [測試執行](#測試執行)
- [測試資料管理](#測試資料管理)
- [日誌與報告](#日誌與報告)
- [技術堆疊](#技術堆疊)
- [未來計劃](#未來計劃)

## 特點

- **多環境支援**：可根據不同環境（如 DEV, SIT, UAT, PROD）切換配置，支持動態調整 URL 和測試資料。
- **高度模組化**：將測試邏輯、頁面物件、動作和數據處理分層設計，維護和擴展更方便。
- **資料表支援**：從 Excel 文件中讀取測試計劃、步驟和測試參數，並使用自定義資料表類進行資料處理。
- **自動截圖**：測試失敗時自動截圖，方便錯誤排查。
- **自動化測試執行**：支持測試計劃的加載和動作的自動執行，按步驟驅動測試流程。

## 架構

本框架遵循 Page Object Model（POM）設計模式，並將測試邏輯分為以下幾個主要部分：

1. **Pages**：定義應用程序的頁面物件，每個頁面物件封裝了一個頁面的操作（如登入、商品列表等）。
2. **Actions**：定義測試動作邏輯，將頁面物件操作組織為可重用的動作（如登入成功、加入購物車等）。
3. **Engine**：負責測試計劃的加載與執行，處理測試流程的控制邏輯。
4. **Toolkit**：提供常用的工具函數，如 WebDriver 管理、日誌記錄、XPath 查找等。
5. **Tests**：具體的測試案例，根據測試計劃執行相應的測試流程。

### 設計理念

- **模組化**：為了讓測試框架更具可擴展性，我們將不同的功能分為多個模組（如頁面物件、動作、測試引擎等），每個模組只關心自己的職責，從而提高維護性和可擴展性。
- **高內聚低耦合**：各個模組之間依賴於接口，而不是具體實現，使得不同部分的變動不會影響其他部分。這有助於快速調整測試邏輯和頁面物件，支持更快速的迭代和擴展。

## 環境設置

1. **安裝 Python 依賴**：
    在根目錄下執行以下命令來安裝所需的 Python 依賴：

    ```bash
    pip install -r requirements.txt
    ```

2. **設定多環境配置**：
    在 `config.py` 中配置不同的環境（DEV, SIT, UAT, PROD），可以根據需求切換測試環境。

    ```python
    ACTIVE_CONFIG = DEV_CONFIG  # 默認使用 DEV 環境
    ```

3. **配置 WebDriver**：
    框架使用 ChromeDriver 來啟動瀏覽器，請確保安裝 `webdriver_manager`，或手動下載並設置相應的 WebDriver。

## 測試執行

1. **測試執行命令**：
    使用 pytest 執行測試：

    ```bash
    pytest
    ```

2. **測試進度與報告**：
    測試執行過程中，會在終端輸出測試結果，並在 `logs` 目錄下生成測試日誌。

    測試失敗時，會自動截圖並保存到 `screenshots` 目錄中。

## 測試資料管理

測試資料通過 `DataTable` 類別進行管理，支持從 Excel 文件中讀取測試計劃、步驟和參數。您可以通過以下步驟來加載測試資料：

1. **從 Excel 加載資料**：
   - 使用 `load_test_plan` 來加載測試計劃。
   - 使用 `load_testplan_dir` 和 `load_test_plan` 方法來解析測試計劃並生成步驟列表。

2. **參數解析**：
   - 測試步驟中的 `Params` 會自動解析為字典，並根據需要推斷參數類型（如 `int`, `float`, `bool`, `None` 等）。

## 日誌與報告

框架集成了日誌記錄功能，所有測試的執行過程會被記錄在 `test_run.log` 中。測試過程中的關鍵步驟和錯誤信息會被自動記錄。

- **日誌輸出**：日誌會同時輸出到控制台和文件中。
- **自動截圖**：測試失敗時會自動截圖，並保存在 `screenshots` 目錄中，便於排查問題。

## 技術堆疊

- **Python 3.x**：主要語言，提供了強大的腳本語言支持和高效的開發體驗。
- **Selenium**：用於 Web 自動化操作，支持瀏覽器操作和元素定位。
- **pytest**：測試框架，負責執行測試、報告生成等。
- **webdriver_manager**：自動管理 WebDriver 版本，無需手動下載和配置。
- **openpyxl**：用於讀取和操作 Excel 文件，支持測試資料的讀取和解析。
- **logging**：日誌模組，用於測試過程中的記錄和錯誤排查。
- **ContextVar**：用於管理運行上下文，支持多測試並行執行。

## 未來計劃

- **支持更多瀏覽器**：計劃支持更多瀏覽器（如 Firefox、Edge）的 WebDriver 操作。
- **CI/CD 集成**：將測試框架集成到 Jenkins 或 GitLab CI 等持續集成系統中，實現自動化測試。
- **報告功能加強**：未來計劃加入測試報告生成，如 HTML 報告、測試覆蓋率報告等。

## 本框架能展現的能力

此專案框架展示了以下工程化能力，面試時能有效證明候選人在自動化領域的深度：

1. **具備獨立設計企業級自動化框架的能力**  
	- 能從底層組件（BasePage、Browser Handler）建立框架基礎
	- 能將 Selenium 操作抽象化，避免測試程式出現過度重複邏輯
2. **具備大型專案經驗並能轉化成工程方法論**  
	- 將 UFT 一些成熟的做法（Environment、多層架構）轉換到 Python 生態系
	- 彌補許多使用 Selenium 生態常忽略的維運設計面
3. **清楚分層與降低耦合的設計能力**  
	- base / pages / toolkit / config 的分層設計有助於長期維護
	- 測試碼只負責行為，不與 Selenium 元素操作耦合
4. **考慮企業導入場景與可擴充性**  
	- 框架預留多環境、多瀏覽器、CI/CD、測試報告整合空間
	- 模組化設計方便團隊協作與日後功能擴充
5. **能將不完整或混亂的自動化流程重新整理成框架**  
	- 若企業已有部分測試腳本，可基於此框架快速收斂
	- 若從零開始，也能當成自動化專案模板直接使用
